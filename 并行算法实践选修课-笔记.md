# 并行算法实践-笔记

## 一、日常使用

#### 1、并发方式：mpi、openmp

- mpi：并发系统手动挡，本实验使用

- openmp：并发系统自动挡，本实验不适用

#### 2、远程登录方式

- minicom：主要用于修改 IP 地址，修改密码等。

  ```
  进入方式：首先选择进入的核心编号 `gpio number` ，再输入minicom。
  退出方式：ctrl+A  ->  x  ->  回到前端
  ```

- SSH登录：本实验日常使用方式，例：

  ```
  ssh root@192.168.100.1         //ssh登录
  ```

  


#### 3、单实验箱运行步骤(基本完善）
- 打开前端电脑，登录

- 打开要使用的高性能核心

- 在前端状态下，利用 scp 工具把代码上传到待使用的核心，例如: 

  ```sh
  scp /path/file  User@host:/LocalPathorFile      //这是标准语句格式
  scp rank.c root@192.168.100.1                   //这是实际用例。如果需要多核心并行，需要把代码上传到每个核心。
  ```

- 上传代码需要高性能核心的密码，如果忘记，可更改

- 此时进入高性能核心

- 在核心中设置运行程序的核心数量：

  ```sh
  mpdboot -n 1~4 -f mpd.hosts          //中间的1~4，填入一个数
  ```

- 编译程序：mpicc      （可在程序文件夹的README查看具体用法）

- 运行程序：mpirun   （可在程序文件夹的README查看具体用法，编译成功无法运行可尝试在文件前加上“ ./ ”）


#### 4、多盒子串联运行步骤（待完善）
- ifconfig 查看当前 IP
- gpio 1 启用  1 号多处理器
- 设置 IP ：
```sh
ifconfig eth1 192.168.100.38 netmask 255.255.255.0
```
- 重启系统，倒数时按任意键暂停，此时修改启动 IP ：
```sh
（PMON串口调试）：setmac2：~~~~~~~~~~~~：0x（ x 为想要的编号）
set nfsip 192.168.0.0x（ x 为想要的编号）（默认 IP：192.168.0.250）
```
- 正常重启

- ping 另一个箱子的处理器 IP （成功即连上）

  


## 二、问题处理
#### 1、更改核心的登录密码

有的核心的密码被改过，上传文件和登录核心都会失败，此时需要更改核心登陆密码。具体代码如下：

```sh
gpio 1             //选择更改的核心序号：1~4
minicom            //进入此核心
passwd             //输入更改密码命令
请输入你的密码：
```

#### 2、查看核心的IP地址

登录核心后输入：`ifconfig `  即可 

#### 3、分辨前端节点和高性能核心

[root ~*%^%*&$] ：      这种带中括号的是前端节点。

 root ~*%^%*&$  ：      这种**不带**中括号的是高性能核心。

#### 4、程序可以编译但是无法运行

- 可尝试在可尝试在运行文件前加上“ ./ ”，使用当前目录
- 可能没有设置启动参数，可以通过  `mpdboot -n 1~4 -f mpd.hosts`  设置。
- 设置启用参数仍然无法运行，可能  `mpd.hosts`  文件内容需要更改。





#### Reference

[并行计算：MPI总结](https://blog.csdn.net/qq_40765537/article/details/106425355)

[此实验箱简介](http://www.loongson.cn/business/general2/jiaoxue/jiaoxueshiyanxiang/2015/09/69.html)

[scp命令语法](https://blog.csdn.net/weixin_34177064/article/details/92177168)




